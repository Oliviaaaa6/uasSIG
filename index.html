<!doctype html>
<html lang="en">
  <head>
    <!-- Helps the browser identify support for mobile applications -->
    <meta charset="utf-8" />

    <meta
      name="viewport"
      content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width"
    />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- Title on the browser tab -->
    <title>WebGIS Sebaran Masjid Daerah Jawa Tengah</title>
    <!-- Leaflet CSS Library -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css"
    />
    <!-- Leaflet JavaScript Library -->
    <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
    <!-- Style for the fullscreen map display -->
    <style>
      html,
      body,
      #map {
        height: 100%;
        width: 100%;
        margin: 0px;
      }

      /* ===== JUDUL PETA (VERSI CUSTOM) ===== */
      .judul-peta {
        position: absolute;
        top: 15px;
        left: 50%;
        transform: translateX(-50%);

        /* --- GANTI WARNA DI SINI --- */
        background: rgba(
          27,
          94,
          32,
          0.85
        ); /* Hijau Masjid dengan transparansi 85% */
        /* background: rgba(184, 134, 11, 0.85); -- Opsi jika ingin warna Emas -- */

        color: white;

        /* --- ATUR PANJANG DI SINI --- */
        padding: 10px 40px; /* 10px atas-bawah, 40px kiri-kanan (biar makin panjang) */
        min-width: 350px; /* Memaksa kotak punya panjang minimal tertentu */

        border-radius: 12px; /* Sudut kotak lebih halus */
        border: 2px solid #ffd700; /* Garis tepi emas tipis agar mewah */
        z-index: 1000;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      .judul-peta h2 {
        font-size: 20px;
        margin: 0;
        text-transform: uppercase; /* Membuat huruf besar semua agar tegas */
        letter-spacing: 1px; /* Jarak antar huruf sedikit renggang */
      }

      .judul-peta p {
        font-size: 15px;
        margin: 5px 0 0 0;
        opacity: 0.9;
      }

      /* Styling untuk Tombol Home */
      .home-btn {
        background-color: white;
        padding: 8px 12px;
        cursor: pointer;
        border: 2px solid rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        font-weight: bold;
        color: #333;
        background-clip: padding-box;
        text-align: center;
        box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
      }

      .home-btn:hover {
        background-color: #f4f4f4;
      }

      .leaflet-tooltip {
        background: rgba(27, 94, 32, 0.85);
        pointer-events: none !important;
        color: white;
        border: none;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
        font-weight: 600;
        padding: 6px 10px;
      }

      /* PANEL LEGENDA MODERN */
      .legend-panel {
        position: fixed;
        left: 13px;
        top: 130px;
        bottom: 19px;
        z-index: 9999;
        width: 170px;
        padding: 10px;
        border-radius: 14px;
        background: linear-gradient(
          135deg,
          rgba(231, 248, 255, 0.95),
          rgba(255, 255, 255, 0.92)
        );
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
        border: 1px solid rgba(0, 0, 0, 0.08);
        backdrop-filter: blur(6px);
      }

      .legend-title {
        display: flex;
        align-items: baseline;
        gap: 10px;
        margin-bottom: 12px;
      }

      .legend-title .big {
        font-size: 14px;
        font-weight: 700;
        letter-spacing: 0.8px;
        line-height: 1;
      }

      .legend-title .small {
        font-size: 10px;
        opacity: 0.7;
      }

      /* LIST ITEM */
      .legend-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .legend-card {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 6px 8px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.07);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease,
          background 0.2s ease;
      }

      .legend-card:hover {
        transform: translateY(3px);
        box-shadow: 0 10px 22px rgba(0, 0, 0, 0.14);
        background: rgba(255, 255, 255, 1);
      }

      .legend-swatch {
        width: 11px;
        height: 11px;
        border-radius: 5px; /* beda dari contoh (bukan kotak bulat penuh) */
        border: 2px solid rgba(0, 0, 0, 0.08);
        flex: 0 0 auto;
      }

      .legend-name {
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 0.2px;
      }

      /* ACTIVE STATE */
      .legend-card.active {
        outline: 2px solid rgba(255, 215, 0, 0.45);
        background: rgba(255, 253, 230, 0.95);
      }

      /* RESET BUTTON */
      .legend-reset-btn {
        margin-top: 11px;
        width: 100%;
        padding: 6px;
        border-radius: 10px;
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(235, 255, 245, 0.95);
        font-weight: 600;
        letter-spacing: 0.8px;
        cursor: pointer;
        transition:
          transform 0.12s ease,
          background 0.12s ease;
      }

      .legend-reset-btn:hover {
        transform: translateY(-1px);
        background: rgba(220, 255, 240, 1);
      }

      /* Membuat kotak skala lebih kontras */
      .leaflet-control-scale-line {
        background: rgba(
          255,
          255,
          255,
          0.7
        ); /* Memberi background putih transparan */
        border: 2px solid #333; /* Mempertebal garis skala */
        border-top: none; /* Gaya khas skala peta */
        color: black; /* Warna teks angka */
        font-weight: bold; /* Mempertebal angka skala */
        font-size: 12px; /* Memperbesar ukuran teks */
      }

      .label-kab {
        font-weight: 750;
        color: #e0ffc4; /* Kuning Gading Cerah */
        pointer-events: none !important;
        background: none !important;
        border: none !important;
        box-shadow: none !important;
        font-size: 12px;
        text-transform: uppercase;
        /* Glow Biru Tua atau Hitam */
        text-shadow:
          1px 1px 3px rgba(0, 0, 0, 1),
          -1px -1px 3px rgba(0, 0, 0, 1);
      }

      /* ===== PENJELASAN SINGKAT (INFO BOX) ===== */
      .desc-box {
        position: absolute;
        top: 230px; /* kalau nabrak panah / judul, naik-turun aja */
        right: 18px;
        width: 260px;
        background: rgba(255, 255, 255, 0.92);
        border-radius: 14px;
        padding: 10px 12px;
        z-index: 1200;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.18);
        font-size: 12px;
        line-height: 1.4;
      }
      .desc-box b {
        font-size: 12px;
      }

      /* ===== NORTH ARROW ===== */
      .north-arrow {
        position: absolute;
        top: 130px;
        right: 30px;
        width: 90px;
        z-index: 1000;
      }
    </style>
  </head>

  <body>
    <!-- HTML Block to display the map -->
    <div class="judul-peta">
      <h2>Sebaran Masjid</h2>
      <p>Wilayah Jawa Tengah</p>
    </div>

    <!-- ARAH MATA ANGIN -->
    <img src="assets/mataangin.png" class="north-arrow" />

    <div class="desc-box">
      <b>Penjelasan singkat:</b><br />
      Peta ini menampilkan sebaran 30 lokasi masjid di 10 kab/kota Jawa Tengah.
      Ikon masjid menunjukkan titik lokasi, sedangkan warna wilayah membedakan
      kab/kota. Klik ikon untuk melihat nama, alamat, dan kontak.
    </div>

    <div class="legend-panel" id="legendPanel">
      <div class="legend-title">
        <div class="big">LEGENDA PETA</div>
      </div>

      <div class="legend-list" id="legendList"></div>

      <button class="legend-reset-btn" id="resetLegendBtn">
        RESET PILIHAN
      </button>
    </div>

    <div id="map"></div>
    <script>
      /* Initial Map */
      //lat, long, zoom (the initial view can be determined from Google Earth)
      var map = L.map("map").setView([-7.15, 110.65], 9);

      L.DomEvent.disableClickPropagation(
        document.getElementById("legendPanel"),
      );
      L.DomEvent.disableScrollPropagation(
        document.getElementById("legendPanel"),
      );

      /* Tile Basemap */
      var basemap0 = L.tileLayer(
        "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
          maxZoom: 19,
          attribution: "Nama: Olivia Wahyu Ramadhani | NIM: 24611024",
        },
      );
      basemap0.addTo(map);

      var Esri_WorldImagery = L.tileLayer(
        "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
        {
          attribution: "Nama: Olivia Wahyu Ramadhani | NIM: 24611024",
        },
      );

      var MtbMap = L.tileLayer(
        "http://tile.mtbmap.cz/mtbmap_tiles/{z}/{x}/{y}.png",
        {
          attribution: "Nama: Olivia Wahyu Ramadhani | NIM: 24611024",
        },
      );

      var Stadia_StamenWatercolor = L.tileLayer(
        "https://tiles.stadiamaps.com/tiles/stamen_watercolor/{z}/{x}/{y}.{ext}",
        {
          minZoom: 1,
          maxZoom: 16,
          ext: "jpg", // ‚úÖ PENTING! karena URL pakai {ext}
          attribution: "Nama: Olivia Wahyu Ramadhani | NIM: 24611024",
        },
      );

      // basemap0.addTo(map); //Calls the basemap to be displayed when the page is loaded
      /*Control Layer*/
      var baseMaps = {
        "Open Street Map": basemap0,
        "Open MTB MAP": MtbMap,
        "Esri WorldImagery": Esri_WorldImagery,
        Stadia_Stamen: Stadia_StamenWatercolor,
      };

      /* ================= SKALA ================= */
      L.control
        .scale({
          position: "bottomright",
          metric: true,
        })
        .addTo(map);

      // 5) Tombol HOME
      let lastBounds = null;
      const HomeControl = L.Control.extend({
        options: { position: "topleft" },
        onAdd: function () {
          const div = L.DomUtil.create("div", "home-btn");
          div.innerHTML = "Home";
          div.onclick = () => {
            if (lastBounds) map.fitBounds(lastBounds, { padding: [40, 40] });
            else map.setView([-7.15, 110.65], 9);
          };
          return div;
        },
      });
      map.addControl(new HomeControl());

      var Layers = {};
      var layerControl = L.control.layers(baseMaps, Layers, {
        collapsed: false,
      });
      layerControl.addTo(map);

      // List of Locations: array of objects (30 Masjid Daerah JAWA TENGAH)
      var locations = [
        {
          name: "Masjid Besar Al-Atiiq Kauman Salatiga",
          address:
            "Jl. KH Wahid Hasyim No.2, Sidorejo Lor, Kec. Sidorejo, Kota Salatiga, Jawa Tengah 50714",
          phone: "628122812341",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid+Besar+Al-Atiiq+Kauman+Salatiga",
          lat: -7.329246,
          lng: 110.503252,
        },
        {
          name: "Masjid Jami' Baitusy Syukur",
          address:
            "MFRG+WP8, Blotongan, Sidorejo, Salatiga City, Central Java 50716",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Jami%27%20Baitusy%20Syukur@-7.323611,110.511944",
          lat: -7.323611,
          lng: 110.511944,
        },
        {
          name: "Masjid Pandawa",
          address:
            "Jl. Ahmad Yani No.8b, Kalicacing, Kec. Sidomukti, Kota Salatiga, Jawa Tengah 50724",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Pandawa@-7.345833,110.490278",
          lat: -7.345833,
          lng: 110.490278,
        },
        {
          name: "Masjid Al-Aqsha Menara Kudus",
          address:
            "Jl. Menara No.25b, Pejaten, Langgardalem, Kec. Kota Kudus, Kabupaten Kudus, Jawa Tengah 59315",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Al-Aqsha%20Menara%20Kudus@-6.804722,110.832778",
          lat: -6.804722,
          lng: 110.832778,
        },
        {
          name: "Masjid Kapal Assafinatun Najah",
          address:
            "Jl. Kyai Padak, Podorejo, Kec. Ngaliyan, Kota Semarang, Jawa Tengah 50214",
          phone: "-",
          rating: 4.1,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Kapal%20Assafinatun%20Najah@-7.025556,110.334444",
          lat: -7.025556,
          lng: 110.334444,
        },
        {
          name: "Masjid Agung Kudus",
          address:
            "Jl. Simpang Tujuh, Kudus, Demaan, Kec. Kota Kudus, Kabupaten Kudus, Jawa Tengah 59317",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Kudus@-6.807778,110.838333",
          lat: -6.807778,
          lng: 110.838333,
        },
        {
          name: "Masjid Jami' Nurul Haq",
          address:
            "Jl. Raya Kudus - Jepara No.374, Krajan, Prambatan Kidul, Kec. Kaliwungu, Kabupaten Kudus, Jawa Tengah 59332",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Jami%27%20Nurul%20Haq@-6.822222,110.8525",
          lat: -6.822222,
          lng: 110.8525,
        },
        {
          name: "Masjid Jami' Al-Urwatil Wutsqo",
          address:
            "Gg. K.H. Busyiri, Krajan, Panjunan, Kec. Kota Kudus, Kabupaten Kudus, Jawa Tengah 59317",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Jami%27%20Al-Urwatil%20Wutsqo@-6.79,110.84",
          lat: -6.79,
          lng: 110.84,
        },
        {
          name: "Masjid Agung Kabupaten Semarang",
          address:
            "Jl. Ahmad Yani, Putotan, Sidomulyo, Kec. Ungaran Tim., Kabupaten Semarang, Jawa Tengah 50514",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Kabupaten%20Semarang@-7.123611,110.403889",
          lat: -7.123611,
          lng: 110.403889,
        },
        {
          name: "Masjid Wahyu",
          address:
            "Jl. Jend. Sudirman No.144, Kaliaang, Langensari, Kec. Ungaran Bar., Kabupaten Semarang, Jawa Tengah 50518",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Wahyu@-7.275556,110.457222",
          lat: -7.275556,
          lng: 110.457222,
        },
        {
          name: "Masjid Jami' Nurul Islam",
          address:
            "Jl. Siliwangi No.570, Purwoyoso, Kec. Ngaliyan, Kota Semarang, Jawa Tengah 50184",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Jami%27%20Nurul%20Islam@-6.995,110.443333",
          lat: -6.995,
          lng: 110.443333,
        },
        {
          name: "Masjid Raya Baiturrahman Semarang",
          address:
            "Jl. Pandanaran No.126, Pekunden, Kec. Semarang Tengah, Kota Semarang, Jawa Tengah 50241",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Raya%20Baiturrahman%20Semarang@-6.990278,110.4225",
          lat: -6.990278,
          lng: 110.4225,
        },
        {
          name: "Masjid Agung Semarang (Kauman)",
          address:
            "Jl. Aloon-Aloon Bar. No.11, Bangunharjo, Kec. Semarang Tengah, Kota Semarang, Jawa Tengah 50138",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Semarang%20(Kauman)@-6.973333,110.420833",
          lat: -6.973333,
          lng: 110.420833,
        },
        {
          name: "Masjid Muhajirin Payung Asri",
          address:
            "Jl. Payung Asri Bar. IV, Pudakpayung, Kec. Banyumanik, Kota Semarang, Jawa Tengah 50265",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Muhajirin%20Payung%20Asri@-7.065833,110.413611",
          lat: -7.065833,
          lng: 110.413611,
        },
        {
          name: "Masjid Agung Demak",
          address:
            "Jl. Sultan Fatah No.57, Kauman, Bintoro, Kec. Demak, Kabupaten Demak, Jawa Tengah 59511",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Demak@-6.894556,110.637043",
          lat: -6.894556,
          lng: 110.637043,
        },
        {
          name: "Masjid Raya Darussalam Demak",
          address:
            "Jl. Kyai Jebat No.09, Petengan Selatan, Bintoro, Kec. Demak, Kabupaten Demak, Jawa Tengah 59511",
          phone: "-",
          rating: 4.6,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Raya%20Darussalam%20Demak@-6.891389,110.638611",
          lat: -6.891389,
          lng: 110.638611,
        },
        {
          name: " Masjid Agung Turirejo",
          address:
            "Ds, Turirejo, Kec. Demak, Kabupaten Demak, Jawa Tengah 59517",
          phone: "-",
          rating: 4.4,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Turirejo@-6.866667,110.65",
          lat: -6.866667,
          lng: 110.65,
        },
        {
          name: "Masjid Agung Darussalam",
          address:
            "Jl. Brigjen. Katamso No.2, Kepatian, Temanggung II, Kec. Temanggung, Kabupaten Temanggung, Jawa Tengah 56213",
          phone: "-",
          rating: 4.8,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Darussalam@-7.315,110.183611",
          lat: -7.315,
          lng: 110.183611,
        },
        {
          name: "Masjid Baiturrohmah - Kranggan, Temanggung",
          address:
            "M6P7+Q67, Bolang, Klepu, Kec. Kranggan, Kabupaten Temanggung, Jawa Tengah 56271",
          phone: "-",
          rating: 5.0,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Baiturrohmah%20-%20Kranggan,%20Temanggung@-7.341111,110.218889",
          lat: -7.341111,
          lng: 110.218889,
        },
        {
          name: "Masjid Al-Fatah",
          address:
            "Jl. Temanggung-Kaloran, Malangsari, Gandulan, Kec. Kaloran, Kabupaten Temanggung, Jawa Tengah 56282",
          phone: "-",
          rating: 5.0,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Al-Fatah@-7.305556,110.166667",
          lat: -7.305556,
          lng: 110.166667,
        },
        {
          name: "Masjid Agung Jawa Tengah (MAJT)",
          address:
            "Jl. Gajah Raya, Sambirejo, Kec. Gayamsari, Kota Semarang, Jawa Tengah 50166",
          phone: "6282134970000",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Jawa%20Tengah%20(MAJT)@-6.983785,110.444964",
          lat: -6.983785,
          lng: 110.444964,
        },
        {
          name: "Masjid Agung Boyolali",
          address:
            "Jl. Merbabu No.39, Singorajan, Siswodipuran, Kec. Boyolali, Kabupaten Boyolali, Jawa Tengah 57311",
          phone: "-",
          rating: 4.7,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Boyolali@-7.535278,110.596111",
          lat: -7.535278,
          lng: 110.596111,
        },
        {
          name: "Masjid Al-Hidayah",
          address:
            "Jl. Perintis Kemerdekaan No.999, Bangunharjo, Pulisen, Kec. Boyolali, Kabupaten Boyolali, Jawa Tengah 57316",
          phone: "-",
          rating: 4.6,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Hidayah@-7.525,110.6125",
          lat: -7.525,
          lng: 110.6125,
        },
        {
          name: "Masjid Jami' Al-Ibrahim",
          address:
            "Jl. Purwodadi - Kudus, Penganten, Kec. Grobogan, Kabupaten Grobogan, Jawa Tengah 58154",
          phone: "-",
          rating: 4.6,
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Jami%27%20Al-Ibrahim@-7.091111,110.916111",
          lat: -7.091111,
          lng: 110.916111,
        },
        {
          name: "Masjid Besar Mangunsari",
          address:
            "Kalisari, Mangunsari 007/002, Mangunsari, Kec. Tegowanu, Kabupaten Grobogan, Jawa Tengah 581654",
          phone: "-",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Besar%20Mangunsari@-7.033333,110.85",
          rating: 4.3,
          lat: -7.033333,
          lng: 110.85,
        },
        {
          name: "Masjid Agung Kendal",
          address:
            "Pekauman, Pakauman, Kendal, Kendal Regency, Central Java 51319",
          phone: "-",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Agung%20Kendal@-6.920556,110.201667",
          rating: 4.7,
          lat: -6.920556,
          lng: 110.201667,
        },
        {
          name: "Masjid Baitun Nikmah",
          address:
            "Mannggisan, Langenharjo, Kendal, Kendal Regency, Central Java 51314",
          phone: "-",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Baitun%20Nikmah@-6.916667,110.216667",
          rating: 4.9,
          lat: -6.916667,
          lng: 110.216667,
        },
        {
          name: "Masjid Besar Kauman Sragen",
          address:
            "Kauman, Dusun Kebayanan Krajoyok, Sragen Wetan, Kec. Ngrampal, Kabupaten Sragen, Jawa Tengah 57252",
          phone: "-",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Besar%20Kauman%20Sragen@-7.428889,111.020278",
          rating: 4.8,
          lat: -7.428889,
          lng: 111.020278,
        },
        {
          name: "Masjid Raya Al Falah Sragen",
          address:
            "Jl. Sukowati, Kebayan 3, Sragen Tengah, Kec. Sragen, Kabupaten Sragen, Jawa Tengah 57212",
          phone: "6287854429107",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Raya%20Al%20Falah%20Sragen@-7.427778,111.0225",
          rating: 4.8,
          lat: -7.427778,
          lng: 111.0225,
        },
        {
          name: "Masjid Al Muslim",
          address:
            "Jl. Barito, Cantel Wetan, RT.01/RW.XI, Kutorejo, Sragen Tengah, Kec. Sragen, Kabupaten Sragen, Jawa Tengah 57211",
          phone: "-",
          gmaps:
            "https://www.google.com/maps/search/?api=1&query=Masjid%20Al%20Muslim@-7.433333,111.008333",
          rating: 4.6,
          lat: -7.433333,
          lng: 111.008333,
        },
      ];

      var customIcon1 = L.icon({
        iconUrl: "assets/logomasjid.png", // dari lokal
        iconSize: [25, 25],
      });

      // Loop for marker
      locations.forEach(function (loc) {
        var marker = L.marker([loc.lat, loc.lng], { icon: customIcon1 }).addTo(
          map,
        );
        // 1) Hover: nama masjid muncul saat nyenggol
        marker.bindTooltip(loc.name, {
          direction: "top",
          offset: [0, -10],
          opacity: 0.9,
        });

        // üîπ FUNGSI BINTANG OTOMATIS
        function renderStars(rating) {
          let stars = "";
          let full = Math.floor(rating);
          let half = rating % 1 >= 0.5;

          for (let i = 0; i < full; i++) stars += "‚≠ê";
          if (half) stars += "‚≠ê";

          return stars;
        }

        // üîπ KLIK ‚Üí POPUP DETAIL
        marker.bindPopup(`
          <div style="font-size:13px; line-height:1.5; max-width:250px;">
            <b style="font-size:14px;">${loc.name}</b><br>
            ${renderStars(loc.rating)} <span style="color:#777;">(${loc.rating})</span><br><br>

            <b>Alamat:</b><br>
            ${loc.address}<br><br>

            <b>Kontak:</b><br>
            ${loc.phone}<br><br>


             <a href="${loc.gmaps}" target="_blank"
              style="text-decoration:none; color:#1e88e5;">
              üìç Google Maps
            </a><br>
            <a href="https://wa.me/${loc.phone}" target="_blank"
              style="text-decoration:none; color:#2e7d32;">
              üí¨ WhatsApp
            </a>
          </div>
        `);
      });

      // === FUNGSI WARNA (SEMUA DIBEDAKAN) ===
      function getColor(kab_kota) {
        return kab_kota === "Kota Salatiga"
          ? "#e53935" // merah
          : kab_kota === "Kudus"
            ? "#1e88e5" // biru
            : kab_kota === "Demak"
              ? "#43a047" // hijau
              : kab_kota === "Temanggung"
                ? "#fdd835" // kuning
                : kab_kota === "Boyolali"
                  ? "#8e24aa" // ungu
                  : kab_kota === "Grobogan"
                    ? "#fb8c00" // oranye
                    : kab_kota === "Semarang"
                      ? "#00acc1" // biru toska
                      : kab_kota === "Kota Semarang"
                        ? "#6d4c41" // coklat
                        : kab_kota === "Kendal"
                          ? "#3949ab" // biru tua
                          : kab_kota === "Sragen"
                            ? "#c2185b" // pink tua
                            : "#9e9e9e"; // default abu-abu
      }

      // Simpan layer per kab/kota biar bisa dipanggil saat klik legenda
      var kabLayerIndex = {}; // { "Kudus": layer, ... }
      var jatengLayer = null; // simpan geojson layer utamanya

      // Style default dan style highlight
      function styleDefault(feature) {
        return {
          fillColor: getColor(feature.properties.kab_kota),
          color: "#000",
          weight: 1,
          fillOpacity: 0.2,
        };
      }

      function styleHighlight() {
        return {
          color: "#ffeb3b", // kuning terang
          weight: 3,
          fillOpacity: 0.35,
        };
      }

      function styleHover(feature) {
        return {
          fillColor: getColor(feature.properties.kab_kota),
          color: "#000",
          weight: 2.5, // garis lebih tegas
          fillOpacity: 0.55, // warna jadi lebih ‚Äúkelihatan‚Äù
        };
      }

      function zoomHighlightKab(kabName) {
        // ambil layer kab/kota dari index
        const layer = kabLayerIndex[kabName];
        if (!layer) {
          console.warn("Kab/Kota tidak ditemukan:", kabName);
          return;
        }

        // zoom ke kab/kota
        map.fitBounds(layer.getBounds(), { padding: [30, 30] });

        // flash sebentar pakai feature asli
        layer.setStyle(styleHover(layer.feature));
        if (layer.bringToFront) layer.bringToFront();

        setTimeout(() => {
          jatengLayer.resetStyle(layer); // reset cuma layer itu aja
        }, 700);
      }

      function highlightFeature(e) {
        const layer = e.target;
        layer.setStyle(styleHover(layer.feature)); // pakai feature asli
        if (layer.bringToFront) layer.bringToFront();
      }

      function resetHighlight(e) {
        jatengLayer.resetStyle(e.target); // balik ke style default
      }

      fetch("assets/jat-wilayah.geojson")
        .then((res) => res.json())
        .then((data) => {
          jatengLayer = L.geoJSON(data, {
            style: styleDefault,
            onEachFeature: function (feature, layer) {
              const kab = feature.properties.kab_kota;
              if (!kab) return;

              if (kab) {
                // simpan layer ini ke index
                kabLayerIndex[kab] = layer;

                layer.bindPopup("<b>" + kab + "</b>");
                layer.bindTooltip(kab, {
                  permanent: true,
                  direction: "center",
                  className: "label-kab",
                });

                // ‚úÖ HOVER AUTO BALIK
                layer.on({
                  mouseover: highlightFeature,
                  mouseout: resetHighlight,
                });
              }
            },
          }).addTo(map);
        });

      // === DATA legend (sesuaikan 10 kab/kota kamu) ===
      const legendItems = [
        { name: "Kota Semarang", color: "#6d4c41" },
        { name: "Demak", color: "#43a047" },
        { name: "Kendal", color: "#3949ab" },
        { name: "Kota Salatiga", color: "#e53935" },
        { name: "Kudus", color: "#1e88e5" },
        { name: "Temanggung", color: "#fdd835" },
        { name: "Boyolali", color: "#8e24aa" },
        { name: "Grobogan", color: "#fb8c00" },
        { name: "Semarang", color: "#00acc1" }, // pastikan sama persis dgn GeoJSON
        { name: "Sragen", color: "#c2185b" },
      ];

      // render legend cards
      const legendList = document.getElementById("legendList");
      legendList.innerHTML = legendItems
        .map(
          (it) => `
        <div class="legend-card" data-kab="${it.name}">
          <span class="legend-swatch" style="background:${it.color}"></span>
          <span class="legend-name">${it.name}</span>
        </div>
      `,
        )
        .join("");

      // click legend item ‚Üí active + zoom/highlight
      legendList.addEventListener("click", (e) => {
        const card = e.target.closest(".legend-card");
        if (!card) return;

        // active state
        document
          .querySelectorAll(".legend-card")
          .forEach((el) => el.classList.remove("active"));
        card.classList.add("active");

        // zoom + highlight
        const kab = card.getAttribute("data-kab");
        zoomHighlightKab(kab);
      });

      // reset button
      document
        .getElementById("resetLegendBtn")
        .addEventListener("click", () => {
          // ‚ùó balikin semua polygon ke style awal (pucat)
          if (jatengLayer) jatengLayer.setStyle(styleDefault);

          // ‚ùó balikin view peta ke posisi awal
          map.setView([-7.15, 110.65], 9);

          // ‚ùó hilangkan efek aktif di legenda
          document
            .querySelectorAll(".legend-card")
            .forEach((el) => el.classList.remove("active"));
        });
    </script>
  </body>
</html>
